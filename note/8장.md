# 제네릭과 배열

## Generic

- Generic 이란
    - 자료형의 객체들을 다루는 메소드나 클래스에서 컴파일 시간에 자료형을 검사해 적당한 자료형을 선택할 수 있도록 하기 위함

- Generic 의 일반적인 사용
    - Angle Bracket(`<>`) 사이에 형식 매개변수를 사용해 선언
    - 형식 매개변수는 자료형을 대표하는 용어로 `T` 와 같이 특정 영문의 대분자로 사용

- 간단한 Generic 의 예

```kotlin
class Box<T>(t: T) {
    var name = t
}

fun main() {
    val box1: Box<Int> = Box<Int>(1)
    val box2: Box<String> = Box<String>("Hello")

    println(box1.name)
    println(box2.name)
}
```

### 형식 매개변수의 이름

- 강제사항은 없으나 일종의 규칙처럼 사용됨
    - `E`: 요소(Element)
    - `K`: 키(Key)
    - `N`: 숫자(Number)
    - `T`: 형식(Type)
    - `V`: 값(Value)
    - `S`, `U`, `V` etc.: 두번째, 세번째, 네번째 형식

- 자료형의 추론
    - 자료형이 추론 가능한 경우 Angle Bracket 표현 생략

```kotlin
val box3 = Box(1)
val box4 = Box("Hello")
```

### Generic Class

- 형식 매개변수를 한 개 이상 받는 클래스
    - 인스턴스를 생성하는 시점에서 클래스의 자료형을 정함
    - Generic Class 내에 메소드에도 다음과 같이 형식 매개변수 사용

```kotlin
class MyClass<T> { // 한 개의 형식 매개변수를 가지는 클래스
    fun myMethod(a: T) { // 메소드의 매개변수 자료형에 사용

    }
}
```

- Property 에 지정하는 경우
    - 주 생성자나 부 생성자에 형식 매개변수를 지정해 사용

- 주 생성자의 형식 매개변수

```kotlin
class MyClass<T>(val myProp: T)
```

- 부 생성자의 형식 매개변수

```kotlin
class MyClass<T> {
    val myProp: T

    constructor(myProp: T) {
        this.myProp = myProp
    }
}
```

- 정수형이 사용되어 객체 초기화

```kotlin
var a = MyClass<Int>(12)
println(a.myProp)
println(a.javaClass)
```

- Generic Class 의 자료형 변환하기

```kotlin
open class Parent

class Child : Parent()

class Cup<T>

fun main() {
    val obj1: Parent = Child()
//    val obj2: Child = Parent() // 에러! 하위 형식인 Child 는 Parent 로 변환 불가

//    val obj3: Cup<Child> = Cup<Parent>() // Type MisMatch
//    val obj4: Cup<Parent> = Cup<Child>() // Type MisMatch

    val obj5 = Cup<Child>()
    val obj6: Cup<Child> = obj5
}
```

- 가변성을 주기 위해 `in`, `out` 등을 설정해야 함

### 형식 매개변수의 null 제어

- Generic 의 형식 매개변수는 기본적으로 null 가능한 형태로 선언

```kotlin
class GenericNull<T> {
    fun equalityFunc(arg1: T, arg2: T) {
        println(arg1?.equals(arg2))
    }
}

fun main() {
    val obj1 = GenericNull<String>()
    obj1.equalityFunc("Hello", "World")

    val obj2 = GenericNull<Int?>()
    obj2.equalityFunc(null, 10)
}
```

- `null`을 허용하지 않으려면 특정 자료형으로 제한 -> `<T: Any>`

### Generic Function 혹은 Method

- 해당 함수나 메소드 앞쪽에 `<T>`와 같이 지정
- 자료형의 결정은 함수가 호출될 때 컴파일러가 자료형 추론
- 이 자료형은 반환 자료형과 매개변수 자료형에 사용 가능

```text
fun <형식 매개변수[, ...]> 함수명(매개변수: <매개변수 자료형>[, ...]): <반환 자료형>
```

```kotlin
fun <T> genericFunc(arg: T): T? {} // 매개변수와 반환 자료형에 형식 매개변수 T 가 사용

fun <K, V> put(key: K, value: V): Unit {} // 형식 매개변수가 여러 개인 경우
```

- 배열의 인덱스 찾아내기

```kotlin
fun <T> find(a: Array<T>, target: T): Int {
    for (i in a.indices) { //indices -> 인덱스의 범위
        if (a[i] == target)
            return i
    }
    return -1
}

fun main() {
    val arr1: Array<String> = arrayOf("Apple", "Banana", "Cherry", "Durian")
    val arr2: Array<Int> = arrayOf(1, 2, 3, 4)

    println("arr.indices ${arr1.indices}")
    println(find<String>(arr1, "Cherry"))
    println(find(arr2, 2))
}
```